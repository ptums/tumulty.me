(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{2068:function(e,t,n){"use strict";(function(e,r,i,o){Object.defineProperty(t,"__esModule",{value:!0}),t.PhoneNumberManager=void 0;var a,u,c,l,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(50),d=E(n(16)),p=E(n(1777)),m=n(28),h=E(n(615)),b=E(n(3006)),v=E(n(0)),y=n(12),g=n(31),_=n(3470),N=E(n(3019)),C=n(3020);function E(e){return e&&e.__esModule?e:{default:e}}function S(t){return function(){var n=t.apply(this,arguments);return new e((function(t,r){return function i(o,a){try{var u=n[o](a),c=u.value}catch(e){return void r(e)}if(!u.done)return e.resolve(c).then((function(e){i("next",e)}),(function(e){i("throw",e)}));t(c)}("next")}))}}var w="UNVERIFIED",P="VERIFICATION_STARTED",O="WAITING_FOR_CODE",V="CODE_VALIDATION_STARTED",I="WAITING_FOR_VALIDATION",A="VALIDATION_FAILED",R="VERIFIED",T=t.PhoneNumberManager=r(N.default)((c=u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));l.call(n);var r=n.props,i=r.number,o=r.verified;return n.state={number:i||"",verificationCode:"",verificationState:o?R:w},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"renderVerifying",value:function(){var e=this.state,t=e.isCodeValid,n=e.verificationCode,r=e.verificationState;return r===P?i.createElement(m.Loading,null):i.createElement("div",null,i.createElement("a",{href:"#",styleName:"phone-note",onClick:this.handleStartVerification},i.createElement(f.IconRepeat,{size:"sm"}),i.createElement("span",null,(0,y.__)("Resend verification code"))),i.createElement("p",{id:"code-description"},(0,y.__)("Enter your one-time verification code that was sent to your mobile device:")),i.createElement("div",{styleName:"verification-code"},i.createElement("input",{className:r===A?N.default["error-field"]:N.default.field,type:"text",value:n,onChange:this.handleCodeChange,maxLength:4,"aria-describedby":"code-description"}),i.createElement(p.default,{onClick:this.handleSubmitVerification,variant:"primary",disabled:!t,label:(0,y.__)("Submit")})))}},{key:"renderNotVerifying",value:function(){var e=this.state.verificationState;return i.createElement("div",{styleName:"phone-note"},e===R?i.createElement(f.IconCheckCircled,{size:"sm",color:"black"}):i.createElement(f.IconInfo,{size:"sm",color:"orange"}),i.createElement("p",null,e===R?(0,y.__)('Mobile phone number is verified. Visit <a href="<%= url %>">notifications</a> to disable SMS notifications for this number.',{url:CONFIG.classroomUrl+"/settings/notifications"},{renderHTML:!0}):(0,y.__)("A one-time verification code will be sent to your mobile device.")))}},{key:"render",value:function(){var e=this.props.className,t=this.state,n=t.number,r=t.verificationState,a=(0,C.validatePhoneNumber)(n),u=r===R,c=o.includes([P,O,V,I,A],r),l=(0,y.__)("Send Code");return c?l=(0,y.__)("Verifying..."):u&&(l=(0,y.__)("Verified")),i.createElement("div",{className:e},i.createElement("div",{styleName:"phone-number"},i.createElement(b.default,{styleName:"editor",inputClassName:a||o.isEmpty(n)?N.default.field:N.default["error-field"],value:n,onChange:this.handleNumberChange}),i.createElement(p.default,{onClick:this.handleStartVerification,variant:"primary",disabled:!a||u||c,label:l})),c?this.renderVerifying():this.renderNotVerifying())}}]),t}(i.Component),u.displayName="settings/setting-personal-info/_phone-number-manager",u.propTypes={className:v.default.string,createErrorAlert:v.default.func.isRequired,createNotificationAlert:v.default.func.isRequired,notifyPhoneVerificationComplete:v.default.func.isRequired,number:v.default.string.isRequired,onChange:v.default.func.isRequired,userKey:v.default.string.isRequired,verified:v.default.bool.isRequired},l=function(){var e,t=this;this.handleNumberChange=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=t.state.verificationState,r=n;t.isNumberChanged(e)?r=w:t.props.verified&&(r=R),t.setState({number:e,verificationState:r})},this.handleCodeChange=function(e){var n=e.target.value;t.setState({verificationCode:n,isCodeValid:4===n.length})},this.handleStartVerification=(e=S(regeneratorRuntime.mark((function e(n){var r,i,o,a,u,c,l,s,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r=t.props,i=r.createErrorAlert,o=r.userKey,a=t.state.number,u=(0,_.parsePhoneNumberFromString)(a||"")||{},t.setState({verificationState:P}),e.next=7,h.default.startPhoneNumberVerification(o,u.countryCallingCode,u.nationalNumber,y.i18n.getLocale());case 7:c=e.sent,l=c.success,s=c.error,l?t.setState({verificationState:O}):(t.setState({verificationState:w}),f="InvalidPhoneNumberOrCountryCode"===s?(0,y.__)("Our SMS service does not consider this a valid number. Please check your phone number and try again."):(0,y.__)("An error occurred while trying to generate a verification code. Please try again."),i(f));case 11:case"end":return e.stop()}}),e,t)}))),function(t){return e.apply(this,arguments)}),this.handleSubmitVerification=S(regeneratorRuntime.mark((function e(){var n,r,i,o,a,u,c,l,s,f,d,p,m,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props,r=n.createErrorAlert,i=n.createNotificationAlert,o=n.notifyPhoneVerificationComplete,a=n.onChange,u=n.userKey,c=t.state,l=c.number,s=c.verificationCode,f=(0,_.parsePhoneNumberFromString)(l||"")||{},t.setState({verificationState:V}),e.next=6,h.default.verifyPhoneNumber(u,s,f.countryCallingCode,f.nationalNumber);case 6:d=e.sent,p=d.success,m=d.error,p?(t.setState({verificationState:R}),o(l),i((0,y.__)("Verification Successful! Your mobile number is saved.")),a(l,!0)):(t.setState({verificationState:A}),b="IncorrectVerificationCode"===m?(0,y.__)("Failed to verify. Please check your verification code and try again."):(0,y.__)("An error occurred while trying to validate your verification code. Please try again."),r(b));case 10:case"end":return e.stop()}}),e,t)}))),this.isNumberChanged=function(e){return t.props.number!==e}},a=c))||a,k=d.default.createNotificationAlert,j=d.default.createErrorAlert,x=d.default.notifyPhoneVerificationComplete;t.default=(0,g.connect)(null,{createNotificationAlert:k,createErrorAlert:j,notifyPhoneVerificationComplete:x})(T)}).call(this,n(11),n(10),n(1),n(4))},3006:function(e,t,n){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o,a,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(3007);var c=d(n(3474)),l=d(n(2195)),s=d(n(0)),f=n(12);function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=e(d(n(3018)).default)((a=o=function(e){function t(){return p(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),u(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.inputClassName,i=e.onChange,o=e.value;return r.createElement("div",{styleName:"phone-number-editor",className:t},r.createElement(l.default,{flags:c.default,"aria-label":"Phone Number",placeholder:(0,f.__)("Phone Number"),numberInputProps:{className:n},country:f.i18n.getCountryCode(),value:o,onChange:i}))}}]),t}(r.Component),o.displayName="settings/setting-personal-info/_phone-number-editor",o.propTypes={className:s.default.string,inputClassName:s.default.string,onChange:s.default.func.isRequired,value:s.default.string.isRequired},i=a))||i;t.default=h}).call(this,n(10),n(1))},3018:function(e,t,n){e.exports={"phone-number-editor":"_phone-number-editor--phone-number-editor--213bi"}},3019:function(e,t,n){e.exports={field:"_phone-number-manager--field--2w6Pz form--input-field--1iAH4","error-field":"_phone-number-manager--error-field--14-Ia _phone-number-manager--field--2w6Pz form--input-field--1iAH4 form--error-field--10p67","phone-number":"_phone-number-manager--phone-number--2gD6Y",editor:"_phone-number-manager--editor--3GNjo","verification-code":"_phone-number-manager--verification-code--1Uo2T","phone-note":"_phone-number-manager--phone-note--1hGU5"}},3020:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validatePhoneNumber=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,r.isValidPhoneNumber)(e)};var r=n(2195)}}]);
//# sourceMappingURL=https://s3-us-west-2.amazonaws.com/udacity-classroom-web/js/phone-number-manager.146c1.js.map